
### **일일 개발 작업 리포트 (Daily Engineering Log)**

| | |
| :--- | :--- |
| **프로젝트명** | Nurihaus AI Influencer Matching PoC |
| **작업 일자** | 2025. 11. 18 (Week3) |
| **작성자** | 박용락 (AI서비스팀 매니저) |

---

#### **1. 주요 작업 요약**

- **데이터베이스 연결 보안 강화**: 소스 코드에 노출되어 있던 데이터베이스 접속 정보(URL)를 암호화하고, 환경변수를 통해 관리하도록 시스템 전반의 보안 구조를 개선했습니다.
- **ETL 데이터 적재 로직 수정**: `matches` 테이블에 데이터가 적재되지 않는 현상을 분석하고, "가상 데이터 시뮬레이션 전략"에 따라 학습 데이터를 랜덤 할당 방식으로 생성하도록 ETL 스크립트를 수정했습니다.
- **모델 학습 스크립트 디버깅**: 데이터 로직 수정 후 발생한 모델 학습 스크립트의 변수 정의 오류(`NameError`)를 해결했습니다.

---

#### **2. 상세 작업 내역**

##### **가. 데이터베이스 연결 보안 강화**

- **이슈**: 다수의 파이썬 스크립트(`etl_load.py`, `train.py` 등)에 데이터베이스 접속 URL이 하드코딩되어 있어 보안에 취약했습니다.
- **조치**:
    1. `cryptography` 라이브러리를 도입하여 DB 접속 정보를 암호화하는 유틸리티 스크립트(`encrypt_util.py`)를 개발했습니다.
    2. 암호화된 값과 암호화 키를 `.env` 환경변수 파일로 분리하여 관리하도록 구조를 변경했습니다.
    3. DB 접속이 필요한 모든 스크립트(`etl_nurihaus.py` 포함 8개 파일)가 실행 시점에 `.env` 파일에서 암호화된 정보를 읽어와 메모리상에서만 복호화하여 사용하도록 수정했습니다.
- **결과**: 소스 코드에서 민감한 접속 정보를 완전히 제거하여 보안을 강화했습니다.

##### **나. `matches` 테이블 데이터 누락 문제 해결**

- **이슈**: `etl_nurihaus.py` 실행 시 `creators`와 `campaigns` 테이블에는 데이터가 정상 적재되었으나, `matches` 테이블은 비어있는 현상이 발생했습니다.
- **분석**: 원인은 샘플링된 크리에이터 데이터와 스폰서십 게시물 데이터 간에 일치하는 `username`이 없어 `INNER JOIN` 시 결과가 반환되지 않았기 때문입니다. 이는 코드 로직의 버그가 아닌, 샘플 데이터의 한계로 분석되었습니다.
- **조치**:
    1. 보고서의 "가상 데이터 시뮬레이션 전략"에 따라, `load_matches` 함수의 로직을 수정했습니다.
    2. 기존의 `username` 기반 매칭 로직을 제거하고, DB에 적재된 크리에이터(`creator_id`)에게 스폰서십 성과(ROI) 데이터를 무작위로 할당하는 방식으로 변경했습니다.
- **결과**: `matches` 테이블에 2,000개의 가상 학습 데이터 생성을 완료하여, AI 모델 학습이 가능한 데이터 기반을 마련했습니다.

##### **다. 모델 학습 스크립트 오류 수정**

- **이슈**: `train.py` 실행 시 `NameError: name 'engine' is not defined` 오류가 발생했습니다.
- **분석**: 제가 이전에 `train.py` 파일을 수정할 때, `train_model` 함수 내에서 `engine` 변수가 사용되기 전에 정의되지 않은 스코프(Scope) 문제를 확인했습니다. 또한, 복호화에 필요한 `Fernet` 라이브러리 임포트도 누락되었습니다.
- **조치**: `train_model` 함수 시작 부분에서 DB 접속 및 `engine` 변수 초기화가 먼저 수행되도록 코드 위치를 조정하고, `Fernet` 라이브러리를 임포트하도록 수정했습니다.
- **결과**: 모델 학습 스크립트가 정상적으로 데이터베이스에 연결하여 학습 데이터를 가져올 수 있도록 수정되었습니다.

---

#### **3. 성과 및 다음 단계**

- 금일 작업을 통해 PoC 프로젝트의 보안성을 향상시켰으며, 데이터 시뮬레이션 전략을 적용하여 모델 학습의 선결 조건인 학습 데이터셋 구축을 완료했습니다.
- 이제 모든 데이터 파이프라인이 정상적으로 동작하므로, 다음 단계인 **AI 모델 학습 및 성능 평가를 본격적으로 진행**할 수 있습니다.
